# TIL _데이터 종류와 파이프라인 구축

# 데이터의 종류

<aside>
💭 출처 : 데이터 분석을 위한 SQL 레시피

</aside>

### 1. 업무 데이터

- 업무 데이터 설명 : 
서비스와 시스템을 운용하기 위한 목적으로 구축된 데이터베이스에 존재하는 데이터
    - 예시) 회원 데이터, 구매 데이터, 리뷰 데이터 등 날짜,시각 등이 함께 포함되는 경우가 많다.

### 2. 로그 데이터

- 로그 데이터 설명 :
서비스를 운영하면서 생기는 모든 행위(클릭, 스크롤, 머무르기 등)를 기록(로그)로 남긴 데이터
    - 통계 또는 분석을 주 용도로 설계된 데이터
    - 특정 태그를 포함해서 전송된 데이터
    - 특정 행동을 서버 측에서 출력한 데이터
- 로그데이터 축적방법
    - **구글 애널리틱스 처럼 HTML에 특정 태그를 집어넣고 데이터 전송 (비컨 형태)**
        - 크롤러의 영향을 적게 받는다.
    - 서버에서 로그를 출력 (서버형태)
        - 크롤러의 접근을 막는 것은 거의 불가능하다. 의도하지 않은 로그를 제거하는 과정이 필요하다
        

# 데이터 파이프라인

<aside>
💭 출처 : [Data Pipeline 쉽게 이해하기](https://rk1993.tistory.com/303)

</aside>

- (1) 데이터 생성
    - 데이터를 생성한다는 것은 각 도메인을 맡는 개발자가 데이터를 생성해서 서버로 전송하는 코드를 짠 다는 것을 의미한다.
    - 데이터를 생성할 때는 **어떤 데이터를 어느 단계에서 생성할지 아키텍처를 잘 설계해서 관리하는 것이 중요하다.**
- (2) 데이터 수집
    - 업무 데이터는 따로 데이터 파이프라인을 거치지 않는다.
    - 로그 데이터는 2가지 방법으로 주로 수집된다. ⓐ SAAS분석 툴 ⓑ 회사 데이터 수집 서버
        
        ![Untitled](TIL%20_%E1%84%83%E1%85%A6%E1%84%8B%E1%85%B5%E1%84%90%E1%85%A5%20%E1%84%8C%E1%85%A9%E1%86%BC%E1%84%85%E1%85%B2%E1%84%8B%E1%85%AA%20%E1%84%91%E1%85%A1%E1%84%8B%E1%85%B5%E1%84%91%E1%85%B3%E1%84%85%E1%85%A1%E1%84%8B%E1%85%B5%E1%86%AB%20%E1%84%80%E1%85%AE%E1%84%8E%E1%85%AE%E1%86%A8%20832f0932fb644d6191ef5ae3138ebc5b/Untitled.png)
        
    - SASS분석 툴은 GA, Amplitude 등의 서비스를 의미하는데 이들은 규격에 맞게 데이터를 전송하면 트래픽에 관계 없이 안전하게 데이터를 저장해주는 동시에 분석 & 시각화를 해준다. 하지만 커스터마이징이 불편하고, 다시 저장하고 가공하는 과정이 불편하다. 그래서 규모가 있는 회사에서는 자체적으로 데이터 인프라를 구축하곤 한다.
- (3) 데이터 가공 후 저장
- (4) 데이터 분석/데이터 시각화

# (1) 업무 데이터 → 데이터 베이스 설계

<aside>
💭 참고 자료 : 그림으로 배우는 데이터베이스

</aside>

- 데이터베이스 개발 흐름
    - **요건 정의** : 어떤 문제 상황을 해결해야하는지 정의하고, 이에 따라 어떤 시스템을 만들 것인지 결정한다. 어떤 데이터를 저장해야하는지, 어떤 데이터를 출력해야하는지 등 데이터베이스에 저장하는 항목을 중점적으로 생각해야한다.
    - 설계 : 요건정의를 바탕으로 그것을 실현하기 위해 사양을 결정한다. 데이터 베이스는 어떤 테이블과 컬럼을 둘 것인지, 어떤 컬럼에 어떤 타입이나 제약을 둘것인지 결정한다. 데이터 베이스를 설계 하는 수단으로 ERD를 이용하거나 정규화를 하기도 한다.
    - 개발 : 설계한 내용을 기초로 소프트웨어나 데이터베이스를 만들어 간다. 데이터베이스에서는 SQL 언어 등을 이용하여 테이블을 만들고 컬럼에 제약을 설정하게 된다.
    - 전환 및 운용 : 완성된 시스템을 업무에 적용하기 위해 전환하거나 소프트웨어를 공개하는 등 운용을 개시한다.

# (2) 로그 데이터 → 로그 설계

<aside>
💭 출처 : 현업 기획자 도그냥이 알려주는 서비스 기획 스쿨

</aside>

### 로그 설계의 중요성

- 데이터 활용을 위해 가장 중요한 일 은 기준을 마련하는 것이다. 기준은 데이터 활용에 있어서 핵심이 된다. 같은 이름의 데이터라도 내가 생각한 가설과 다른 데이터라면 목적에 맞춰 활용할 수가 없다. 즉, 데이터는 생성되기 전부터 활용 목적이 분명해야한다.
- 아무것도하지 않아도 데이터는 쌓인다. 그러나 주문 데이터 처럼 명확한 데이터를 제외하면 모든 화면에서 모든 사람의 로그를 쌓아 놓진 않는다. 쌓아놓는다고 해도 가설 없이는 해석이 불가능한 데이터 일 뿐 이다.
- 운영하는 서비스의 데이터를 쌓을 때 차후 활용 가능하도록 설계해야한다.
    - 예시) 위시리스트 페이지의 구매 전환율이란 항목도 분석 목적에 따라 얼마든지 기준이 변경될 수 있다. **어떤 기준인지에 따라 수집해야하는 데이터도 달라질 것이다.**
        - (1) 위시리스트 대비 주문 완료 비율 = 주문완료 페이지PV(페이지에 접속한 수)/ 위시리스트 PV → 페이지 간 접속률 비율일 뿐 특별한 가설을 세울 수 없다.
        - (2) 위시리스트를 통해서 주문 완료된 건수 비율 = 위시리스트를 통해서 일어난 주문 완료 건 수/ 위시리스트 PV
        → 이런 케이스도 목적에 따라 데이터가 달라질 수 있다. 주문에 대한 영향력을 보고 싶다면 주문 후 취소 건수는 제외해야할지 말지를 결정해야한다. 반면 이 케이스에 대한 주문서 UX에 대한 적합도를 판단하려면 위시리스트 PV 대신 위시리스트에서 ‘주문하기’ 버튼 클릭 수를 분모로 삼고 분자에는 취소된 주문 건수까지 모두 포함해야한다.

### 로그 설계 예시 : 2015년에 모바일 리뉴얼 프로젝트

- 당시까지만 해도 분석해서 내밀 데이터가 없어서 모바일 화면 구석구석해서 분석할 만 한 데이터를 찾아보고자 했다.
- 데이터 수집을 위해 페이지별로 가설을 세웠다.
- 제일 기억에 남는 페이지는 ‘딜 매장’의 측정용 데이터였다. 상품이 순서대로 전시되어있었을 때 상품 순번별 클릭수를 기록했고, 스크롤하면서 추가로 상품을 호출해올 때마다 카운트가 쌓이도록 했다. 이렇게 상품이 쭉 늘어져 있을 때 어디까지가 의미 있는 상품인지를 파악하고, 고객의 가독 범위 내에서 효율성 있는 UI를 만들고자 했던 것이다.
- 이러한 분석 덕분에 무절제하게 상품 수를 늘리는 것을 막을 수 있었다.

### GA 도입 프로세스

1. 웹과 앱 내에 구글 제공 스크립트나 SDK(소프트웨어 개발 키트) 삽입
2. **각 화면 영역별로 클릭 수 체크를 위한 클릭 이벤트 명칭 정의**
3. **영역별로 해당 이벤트 명칭이 삽입되도록 개발**
4. 정상 수집 테스트 및 부하 테스트
5. 웹과 앱 배포 및 데이터 정상 수집 여부 확인


### 로그 설계 시 주의사항

- 보고 싶은 데이터라고 하면 끝이 없기에 먼저 지표에 대해 생각하고 그 기반으로 설계해야한다.
- 로그 설계 관련 자료
    - [https://zzsza.github.io/data/2021/06/13/data-event-log-definition/](https://zzsza.github.io/data/2021/06/13/data-event-log-definition/)
    - [https://yozm.wishket.com/magazine/detail/1532/](https://yozm.wishket.com/magazine/detail/1532/)
